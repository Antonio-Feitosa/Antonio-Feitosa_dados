---
title: "D6_Apresentacao"
author: "Antonio Carvalho Feitosa"
date: "6 de outubro de 2018"
output:
  slidy_presentation: default
  ioslides_presentation: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

###Construindo a apresenta??o

```{r}
### INTRODU??O

### ANTECEDENTES E CONTEXTO

### OBTEN??O E TRATAMENTO DOS DADOS

### RESULTADOS E DISCUSS?O

### CONSIDERA??ES FINAIS

### REFER?NCIAS
```



```{r}
dados <- read.csv("https://raw.githubusercontent.com/cursoRunb/cursoENAP2018/master/Aula5/dadosAlunos/antonio/ANTONIO_areairrig1995pib.csv", sep =";", encoding ="latin1")
head(dados)
tail(dados)
head(dados[order(dados$area1000ha, decreasing = TRUE),])
head(dados[order(dados$pib2015, decreasing = TRUE),])

```

### Atribuindo e organizando os dados para an?lise.

```{r}
dados2015pib <- dados[order(dados$pib2015, decreasing = TRUE),]
nrow(dados2015pib)
head(dados2015pib)
tail(dados2015pib)

```

### Imprimindo o gr?fico de pontos, observa-se claramente que existem 2 (dois) $outliers$: Bras?lia-DF e Campos dos Goytacazes-RJ.

```{r}
plot(dados2015pib$municipio,dados2015pib$pib2015,
     xlab = "Municipios", ylab = "PIB em R$ milh?es", main = "Scatter1")

library(ggplot2)

ggplot() + 
  geom_point(aes(x=municipio, y=pib2015), data=dados2015pib) +
  labs(x="Municipios", y="PIB em R$ milhoes", title="Scatter1") +
  theme(plot.title = element_text(hjust = 0.5, color="blue"), 
  axis.text.x = element_blank())
  


```

### Identificando outliers: Bras?lia-DF, Campos dos Goytacazes-RJ e Boa Vista-RR


```{r}
outleir <- c("Brasilia", "Campos_dos_Goytacazes", "Boa_Vista")
outleir

agropecuaria <- c(0.3, 0.3, 7.0)
agropecuaria

adm_publica <- c(44.7, 5.7, 48.0)
adm_publica

com_ind_serv <- c(39.9, 94.0, 37.0)
com_ind_serv

outros <- c(15.1, 0.0, 8.0)
outros

```

```{r}
Outleirs <- data.frame(outleir, agropecuaria, adm_publica, com_ind_serv, outros)
Outleirs

Outleirs2 <- data.frame(name=names(Outleirs), 
          valor=as.numeric(Outleirs[1,]))

ggplot(aes(x="", y=valor, fill=name), data=Outleirs2) + geom_bar(stat="identity") +
  coord_polar("y",start=0)




```

### Excluindo esses 3 (tr?s) munic?pios, considerados __outleirs__ passei a analisar os dados dos outros 97 munic?pios.

```{r}
pib2015A <- dados2015pib
nrow(pib2015A)
head(pib2015A)

```



```{r}
plot(pib2015A$municipio,pib2015A$pib2015, xlab = "Municipios", ylab = "PIB em R$ milh?es", main = "PIB_2015 dos 100 Munic?pios Selecionados")

```


### Imprimindo o _boxplot_ do PIB dos 100 munic?pios selecionados.

```{r}
boxplot(pib2015A$pib2015, ylab = "PIB em R$ milh?es", main = "PIB_2015 dos 100 Munic?pios Selecionados")

ggplot(aes(y=pib2015), data=pib2015A) +
  geom_boxplot() +
  labs(y="PIB em R$ milhoes", title="PIB_2015 dos 100 Munic?pios Selecionados")




```

### Excluindo _outileirs_  para an?lise dos dados.

```{r}
pib2015B <- pib2015A[4:100,]
nrow(pib2015B)
head(pib2015B)

```

### Gerando o gr?fico de pontos para os 97 munic?pios selecionados.

```{r}
plot(pib2015B$municipio,pib2015B$pib2015,
     xlab = "Municipios", ylab = "PIB em R$ milh?es", 
     main = "Scatter2 - PIB_2015 dos 97 Munic?pios Selecionados", 
     col.main = "blue"
     )



```

### Gerando o _boxplot_ para os 97 munic?pios selecionados

```{r}
boxplot(pib2015B$pib2015, ylab = "PIB em R$ milh?es", 
        main = "PIB_2015 dos 97 Munic?pios Selecionados",
        col.main = "blue"
        )

```

### Atualizando os valores de PIB para an?lise

```{r}
AA <- sum(pib2015B$pib2000)
AA
BB <- sum(pib2015B$pib2005)
BB
CC <- sum(pib2015B$pib2010)
CC
DD <- sum(pib2015B$pib2015)
DD

```

```{r}
pib2000_2015 <- c(AA,BB,CC,DD)
pib2000_2015


```

### Atualizando pelo INPC os valores de PIB dos 97 munic?pios selecionados dos anos 2000, 2005, 2010 e 2015 at? 30 de junho de 2018

```{r}
atualiza <- c(3.1101, 2.0095, 1.5779, 1.1258)
atualiza

```

```{r}
pib2000_2015 <- pib2000_2015*atualiza
pib2000_2015

pibMunicipios <- pib2000_2015
pibMunicipios

```

### Atribuindo e atualizando pelo INPC os valores de PIB do Brasil nos anos 2000, 2005, 2010 e 2015 at? 30 de junho de 2018

```{r}
pibBR <- c(1199092, 2170585, 3885847, 6000570)
pibBR

pibBRatual <- pibBR*atualiza
pibBRatual

pibBrasil <- pibBRatual
pibBrasil

```

### Calculando a rela??o entre 2015 e 2000 (pibMunicipios/pibBrasil)

```{r}
razaoPIB <- 100*(pibMunicipios/pibBrasil)
razaoPIB

```

### Calculando a varia??o entre 2015 e 2000 (pibMunicipios/pibBrasil)

```{r}
variacao <- razaoPIB[4]/razaoPIB[1]
variacao


```

### Calculando a rela??o entre 2015 e 2000 (pibMunicipios/pibBrasil) usando dataframe

```{r}
Anos <- c(2000, 2005, 2010, 2015)
Anos

```


```{r}
tabela <- data.frame(Anos, pibBrasil, pibMunicipios)
tabela

```

### Calculando as varia??es entre 2015 e 2000 para os Munic?pios

```{r}
variacaoMUN <- 100*(tabela[4,3]-tabela[1,3])/tabela[1,3]
variacaoMUN

```

### 

```{r}
plot(tabela$Anos , tabela$pibMunicipios,
     xlab = "Anos", ylab = " PIB em R$ milh?es ", 
     main = " PIB dos 76 Munic?pios com irriga??o entre 2000 e 2015 ",
     col = "red",
     col.main = "blue", pch = 25,
     lines(tabela$Anos, tabela$pibMunicipios,
           xlim = c(1,4),
           ylim = c(1,4) )
          )

```

### Calculando as varia??es entre 2015 e 2000 para o Brasil

```{r}
plot(tabela$Anos , tabela$pibBrasil, 
     xlab = "Anos", ylab = " PIB em R$ milh?es ", 
     main = " PIB Brasil entre 2000 a 2015 ", 
     col = "blue" , col.main = "red", pch = 9,
     lines(tabela$Anos, tabela$pibBrasil,
           xlim = c(1,4),
           ylim = c(1,4) )
     )

```


```{r}
variacaoBR <- 100*(tabela[4,2]-tabela[1,2])/tabela[1,2]
variacaoBR


```

### Comparando as varia??es entre 2015 e 2000 para Munic?pios e Brasil

```{r}
variacaoMUN - variacaoBR

```

### RESULTADOS E DISCUSS?O

#### Entre 2000 e 2015 o PIB dos 97 munic?pios selecionados (com maior ?rea irrigada) cresceu 83,7% em termos reais((valores atualizados pelo INPC at? 30/06/2018), enquanto o PIB brasileiro cresceu 81,1%. Portanto, no per?odo estudado, o crescimento do PIB dos munic?pios com irriga??o (97 selecionados) foi 2,6% maior que o crescimento do PIB brasileiro (valores absolutos).

#### Considerando as raz?es pibMunicipios/pibBrasil entre 2015 e 2000, a varia??o foi de 1,4%. Isso significa que, em valores atuais(30/06/2018), apesar do elevado crescimento do PIB nacional nesse per?odo, o crescimento do PIB dos munic?pios selecionados foi superior ao crescimento do PIB brasileiro (valores relativos).

### CONSIDERA??ES FINAIS

#### Os resultados deste __Relat?rio Preliminar__ sinalizam que houve crescimento do PIB dos munic?pios que possuem agricultura irrigada maior que o crescimento do PIB brasileiro no S?culo XXI. A avalia??o proposta dever? ser ampliada para 50 anos, incluindo os 5.570 munic?pios e outros indicadores. O roteiro deste Relat?rio dever? servir de base para contrata??o e realiza??o de uma avalia??o completa da __Pol?tica Nacional de Irriga??o__.
